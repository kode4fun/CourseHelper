import{as as R,ai as A,aj as P,y as H,ak as V,z as X,k as a,l as o,p as t,f as s,a7 as r,a8 as c,a9 as m,q as l,a5 as f,a6 as g,s as b,al as C,bA as j,bB as D,b5 as v,b6 as L,bC as B}from"./index-CfG3UZPV.js";import{E as F,a as U}from"./el-col-sonr9z_4.js";import{E}from"./el-message-box-V7E_D8vb.js";import"./el-input-D7PP-q2Z.js";import"./el-overlay-Bo_30KvR.js";const u=w=>(j("data-v-3f19e4c3"),w=w(),D(),w),W={style:{overflow:"auto"}},q={cellspacing:"0",width:"100%;"},J={class:"tbl-title"},O=["colspan","innerHTML"],Q=["colspan","innerHTML"],Y=u(()=>t("td",{rowspan:"5",class:"mw60"}," 序号 ",-1)),Z=u(()=>t("td",{rowspan:"5",class:"mw60"}," 学号 ",-1)),tt=u(()=>t("td",{rowspan:"5",class:"mw60"}," 学生姓名 ",-1)),et=["colspan","innerHTML"],st=u(()=>t("td",{colspan:"3"}," 总评成绩",-1)),nt=["colspan"],at=u(()=>t("td",{class:"mw60"}," 过程",-1)),ot=u(()=>t("td",{class:"mw60"}," 期末考试",-1)),lt=u(()=>t("td",{class:"mw140"}," 总分",-1)),rt=u(()=>t("td",{rowspan:"3"},"100",-1)),ut=u(()=>t("td",{rowspan:"3"},"100",-1)),ct={rowspan:"3"},dt=u(()=>t("br",null,null,-1)),it=u(()=>t("td",{colspan:"3",rowspan:"2"},"平均分",-1)),pt=u(()=>t("td",{colspan:"3"},"课程分目标达成度",-1)),_t=["colspan"],ht=u(()=>t("td",{colspan:"3"},"课程目标达成度",-1)),mt=["colspan"],ft=["colspan"],gt={__name:"PreviewAndExport",setup(w){const{courseGoalCalHelperStore:_}=A(),{getCourseInfo:p,getCourseGoals:S,getStudents:N,CJGCLabel:x,getStatics:T,tblStructure:d}=P(_),y=H("模拟计算"),k=H(!1),z=()=>new Promise(i=>setTimeout(i,1e3+1500*Math.random())),K=async()=>{if(y.value==="停止计算"){k.value=!0,_.stopComputation().then(()=>{y.value="模拟计算",k.value=!1});return}else return await E.confirm("本操作仅用于模拟和预览各考核项成绩，所生成的数据仅为参考演示用途。请勿将产生的数据作为最终结果，否则一切后果自行负责！","警告",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",icon:v(L),duration:0}).then(()=>(y.value="停止计算",_.calulate())).then(async i=>(await z(),i)).then(i=>{if(i.code===0)return B({type:"success",center:!0,message:"计算顺利完成"});if(i.code!==0)return B({type:"error",center:!0,message:"计算完成但遇到错误，请重新计算。"});_.stopComputation()}).catch(i=>{console.log(`计算错误:${i.message}`)}).finally(()=>{y.value="开始计算"})},G=V(),I=()=>{E.confirm("进入新课程后，本次填入的数据将会丢失！<br>请确定已导出数据后再点击确定按钮进入新课程录入！","警告",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",icon:v(L),duration:0}).then(async()=>G.push({name:"index"})).catch(()=>{})};return X(()=>{}),(i,M)=>(a(),o(r,null,[t("div",W,[t("table",q,[t("tr",J,[t("td",{colspan:s(d).nColNumTotal,innerHTML:s(d).title},null,8,O)]),t("tr",null,[t("td",{colspan:s(d).nColNumTotal,class:"tbl-subtitle",innerHTML:s(d).subTitle},null,8,Q)]),t("tr",null,[Y,Z,tt,(a(!0),o(r,null,c(s(d).zbdLables,(e,n)=>(a(),o("td",{colspan:s(d).nSpaned[n],key:"zbt",innerHTML:e,class:"mw170"},null,8,et))),128)),st]),t("tr",null,[(a(!0),o(r,null,c(s(d).nSpaned,(e,n)=>(a(),o("td",{colspan:e,key:`${e}${-n}`},l(s(S)[n].title)+"（*"+l(s(p).arrWeightsSum[n])+"） ",9,nt))),128)),at,ot,lt]),t("tr",null,[(a(!0),o(r,null,c(s(p).arrKHMC,(e,n)=>(a(),o("td",{class:b(["mw60",s(p).arrKHLX[n]===0?"guochengfen":"kaoshifen"]),key:`${e}-${n}`},l(e),3))),128)),rt,ut,t("td",ct,[m("100"),dt,m("（"+l(s(x))+"）",1)])]),t("tr",null,[(a(!0),o(r,null,c(s(p).arrFenzhi,(e,n)=>(a(),o("td",{key:`${e}-${n}`,class:b(s(p).arrKHLX[n]===0?"guochengfen":"kaoshifen")},l(e),3))),128))]),t("tr",null,[(a(!0),o(r,null,c(s(S),(e,n)=>(a(),o(r,{key:`${e}-${n}`},[(a(!0),o(r,null,c(e.kaohes,(h,$)=>(a(),o("td",{key:`${h}-${$}`,class:b(h.kaoheleixing===0?"guochengfen":"kaoshifen")},l(Math.round(h.suozhanfenzhi*s(p).arrWeightsSum[s(p).arrKH2Goal[n]])),3))),128))],64))),128))]),(a(!0),o(r,null,c(s(N),(e,n)=>(a(),o("tr",{key:`${e.stdNo}-${n}-${Math.random()}`},[t("td",null,l(n+1),1),t("td",null,l(e.stdNo),1),t("td",null,l(e.stdName),1),(a(!0),o(r,null,c(e.scores,(h,$)=>(a(),o("td",{key:`${e.stdNo}-${h}-${$}-${Math.random()}`,class:b(s(p).arrKHLX[$]===0?"guochengfen":"kaoshifen")},l(h),3))),128)),t("td",null,l(e.stdGuocheng),1),t("td",null,l(e.stdKaoshi),1),t("td",null,l(e.stdHecheng),1)]))),128)),t("tr",null,[it,(a(!0),o(r,null,c(s(_).getStatics.pjf1,(e,n)=>(a(),o("td",{key:`${e}-${n}`},l(e),1))),128))]),t("tr",null,[(a(!0),o(r,null,c(s(_).getStatics.pjf2,(e,n)=>(a(),o("td",{key:`${e}-${n}`},l(e),1))),128))]),t("tr",null,[pt,(a(!0),o(r,null,c(s(T).fmbdcd,(e,n)=>(a(),o("td",{key:`${e}-${n}-${Math.random()}`,colspan:s(d).nSpaned[n]},l(e),9,_t))),128))]),t("tr",null,[ht,t("td",{colspan:s(d).nColMid},l(s(T).dcd),9,mt)]),t("tr",null,[t("td",{colspan:s(d).nColNumTotal,style:{"text-align":"left","padding-left":"1rem"}}," 注：此表一式二份，一份随试卷存档，一份由任课教师所在学院统一保管。",8,ft)])])]),f(s(U),{justify:"center",style:{"margin-top":"2rem"}},{default:g(()=>[f(s(F),{offset:14,span:10},{default:g(()=>[f(s(C),{type:"warning",onClick:K,disabled:k.value},{default:g(()=>[m(l(y.value),1)]),_:1},8,["disabled"]),f(s(C),{type:"primary",disabled:""},{default:g(()=>[m("导出")]),_:1}),f(s(C),{onClick:M[0]||(M[0]=e=>i.$router.push({name:"import-exam-result"}))},{default:g(()=>[m("上一步")]),_:1}),f(s(C),{onClick:I},{default:g(()=>[m("录入新课程")]),_:1})]),_:1})]),_:1})],64))}},kt=R(gt,[["__scopeId","data-v-3f19e4c3"]]);export{kt as default};
