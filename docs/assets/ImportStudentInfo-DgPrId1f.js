const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CExceler-Cai__Ece.js","assets/xlsx-CIVhsdtn.js","assets/ExcelParser-CizM_o7t.js","assets/index-DakVqAzs.js","assets/index-ChqOP98Q.css","assets/index-DJ6MM7dO.js","assets/el-loading-D5XuAxUM.css"])))=>i.map(i=>d[i]);
import{aT as k,aI as T,aJ as $,o as B,aK as G,V,w as j,x as P,y as i,C as o,bg as g,bh as R,A as a,H as p,aC as s,aL as f,bi as C,bj as L,Q as M,aS as N,bk as A,bl as D,bm as H,bn as J}from"./index-DakVqAzs.js";/* empty css                   */import{E as O}from"./index-DJ6MM7dO.js";const z=c=>(H("data-v-78d83ef0"),c=c(),J(),c),K=z(()=>a("div",{class:"tips"},[s(" 1、请点击下方的“下载模板”按钮下载模板文件，在仔细阅读模板文件内的填写说明后填写数据；"),a("br"),s(" 2、因不同课程的指点数据、分值分配等不同，因此"),a("span",{style:{color:"red"}},"各门课程的模板不通用"),s("；"),a("br"),s(" 3、填写数据后，请点击下方的“导入数据”按钮，选中填写完毕的数据文件进行解析；"),a("br"),s(" 4、请保持模板文件的结构，否则可能导致数据解析失败。"),a("br")],-1)),Q={class:"buttons"},q={__name:"ImportStudentInfo",setup(c){const{courseGoalCalHelperStore:u}=T(),{getCourseInfo:n,getCourseGoals:y,getStudents:h,tblStructure:_}=$(u);let m=null,v=null;const d=B(null);async function b(){const e=O.service({fullscreen:!0,text:"正在生成模板文件...."});m||console.log("初始化 CExceler"),await g(()=>import("./CExceler-Cai__Ece.js"),__vite__mapDeps([0,1])).then(S=>{m=S.default});let t=[n.value.majority,`专业${n.value.grade}级${n.value.banji}`,`《${n.value.coursename}》`,"填写模板"];const r=[...n.value.arrCJGC],l=new m(y.value,r,!0);await l.createExcel(),await l.setSubTitle(_==null?void 0:_.value.subTitle.replace(/&nbsp;/g," ")),await l.download(t.join("")),M(()=>e.close())}async function w(){this.files&&(v||await g(()=>import("./ExcelParser-CizM_o7t.js"),__vite__mapDeps([2,3,4,5,6])).then(e=>v=e.default),await v(this.files[0],!1).then(e=>{const{readedCourseInfo:t,readedCourseGoals:r,readedStudents:l}=e;t.department||(t.department="文学与传媒学院"),u.setCourseInfo(t),u.setCourseGoals(r),l.length>0&&u.setStudents([...l.values()])}).then(()=>x.push({name:"preview-and-export"})).catch(e=>{R({type:"error",message:`文件解析错误，请重试！${e.message}`})}))}const E=async()=>d.value.click(),x=G();function I(e){if(h.value.size===0){N.alert("请先导入班级学生信息！","错误",{type:"error",icon:A(D)});return}x.push({name:e})}return V(()=>{d.value.onchange=w}),(e,t)=>(j(),P(o(L),{style:{height:"100%"}},{default:i(()=>[K,a("input",{type:"file",id:"config_file",style:{display:"none"},ref_key:"file_selector",ref:d,accept:".json"},null,512),a("div",Q,[p(o(f),{onClick:t[0]||(t[0]=r=>e.$router.push({name:"set-course-goal-details"}))},{default:i(()=>[s("上一步")]),_:1}),p(o(f),{type:"warning",icon:o(C),onClick:b},{default:i(()=>[s("下载模板")]),_:1},8,["icon"]),p(o(f),{type:"primary",icon:o(C),onClick:E},{default:i(()=>[s("导入数据")]),_:1},8,["icon"]),p(o(f),{onClick:t[1]||(t[1]=r=>I("preview-and-export"))},{default:i(()=>[s("下一步")]),_:1})]),a("input",{type:"file",id:"exam_file",style:{display:"none"},ref_key:"file_selector",ref:d,accept:".xls,.xlsx, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel"},null,512)]),_:1}))}},X=k(q,[["__scopeId","data-v-78d83ef0"]]);export{X as default};
