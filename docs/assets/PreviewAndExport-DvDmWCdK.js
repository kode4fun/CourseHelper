import{as as X,ai as A,aj as P,y as H,ak as V,z as j,k as s,l as a,p as t,f as n,a7 as r,a8 as c,a9 as h,q as l,a5 as m,a6 as f,s as $,al as k,bA as D,bB as G,b5 as v,b6 as L,bC as B}from"./index-BfrW6-gN.js";import{E as U,a as q}from"./el-col-BvXJPdX6.js";import{E}from"./el-message-box-Cgj4YdrX.js";import"./el-input-BPX3NGSa.js";import"./el-overlay-P1xT7ull.js";const u=b=>(D("data-v-d645f1c2"),b=b(),G(),b),F={style:{overflow:"auto"}},J={cellspacing:"0",width:"100%;"},O={class:"tbl-title"},Q=["colspan","innerHTML"],W=["colspan","innerHTML"],Y=u(()=>t("td",{rowspan:"5",class:"mw60"}," 序号 ",-1)),Z=u(()=>t("td",{rowspan:"5",class:"mw60"}," 学号 ",-1)),tt=u(()=>t("td",{rowspan:"5",class:"mw60"}," 学生姓名 ",-1)),et=["colspan","innerHTML"],nt=u(()=>t("td",{colspan:"3"}," 总评成绩",-1)),st=["colspan"],at=u(()=>t("td",{class:"mw60"}," 过程",-1)),ot=u(()=>t("td",{class:"mw60"}," 期末考试",-1)),lt=u(()=>t("td",{class:"mw140"}," 总分",-1)),rt=u(()=>t("td",{rowspan:"3"},"100",-1)),ut=u(()=>t("td",{rowspan:"3"},"100",-1)),ct={rowspan:"3"},dt=u(()=>t("br",null,null,-1)),it=u(()=>t("td",{colspan:"3",rowspan:"2"},"平均分",-1)),pt=u(()=>t("td",{colspan:"3"},"课程分目标达成度",-1)),_t=["colspan"],ht=u(()=>t("td",{colspan:"3"},"课程目标达成度",-1)),mt=["colspan"],ft=["colspan"],gt={__name:"PreviewAndExport",setup(b){const{courseGoalCalHelperStore:_}=A(),{getCourseInfo:g,getCourseGoals:C,getStudents:N,CJGCLabel:x,getStatics:M,tblStructure:d}=P(_),w=H("模拟计算"),T=H(!1),z=()=>new Promise(i=>setTimeout(i,1e3+1500*Math.random())),K=async()=>{if(w.value==="停止计算"){T.value=!0,_.stopComputation().then(()=>{w.value="模拟计算",T.value=!1});return}else return await E.confirm("本操作仅用于模拟和预览各考核项成绩，所生成的数据仅为参考演示用途。请勿将产生的数据作为最终结果，否则一切后果自行负责！","警告",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",icon:v(L),duration:0}).then(()=>(w.value="停止计算",_.calulate())).then(async i=>(await z(),i)).then(i=>{if(i.code===0)return B({type:"success",center:!0,message:"计算顺利完成"});if(i.code!==0)return B({type:"error",center:!0,message:"计算完成但遇到错误，请重新计算。"});_.stopComputation()}).catch(i=>{console.log(`计算错误:${i.message}`)}).finally(()=>{w.value="开始计算"})},I=V(),R=()=>{E.confirm("进入新课程后，本次填入的数据将会丢失！<br>请确定已导出数据后再点击确定按钮进入新课程录入！","警告",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",icon:v(L),duration:0}).then(async()=>I.push({name:"index"})).catch(()=>{})};return j(()=>{}),(i,S)=>(s(),a(r,null,[t("div",F,[t("table",J,[t("tr",O,[t("td",{colspan:n(d).nColNumTotal,innerHTML:n(d).title},null,8,Q)]),t("tr",null,[t("td",{colspan:n(d).nColNumTotal,class:"tbl-subtitle",innerHTML:n(d).subTitle},null,8,W)]),t("tr",null,[Y,Z,tt,(s(!0),a(r,null,c(n(d).zbdLables,(e,o)=>(s(),a("td",{colspan:n(d).nSpaned[o],key:"zbt",innerHTML:e,class:"mw170"},null,8,et))),128)),nt]),t("tr",null,[(s(!0),a(r,null,c(n(d).nSpaned,(e,o)=>(s(),a("td",{colspan:e,key:`${e}${-o}`},l(n(C)[o].title)+"（*"+l(n(C)[o].weights)+"） ",9,st))),128)),at,ot,lt]),t("tr",null,[(s(!0),a(r,null,c(n(g).arrKHMC,(e,o)=>(s(),a("td",{class:$(["mw60",n(g).arrKHLX[o]===0?"guochengfen":"kaoshifen"]),key:`${e}-${o}`},l(e),3))),128)),rt,ut,t("td",ct,[h("100"),dt,h("（"+l(n(x))+"）",1)])]),t("tr",null,[(s(!0),a(r,null,c(n(C),e=>(s(),a(r,{key:e},[(s(!0),a(r,null,c(e.kaohes,(o,p)=>(s(),a("td",{key:o,class:$(n(g).arrKHLX[p]===0?"guochengfen":"kaoshifen")},l(o.suozhanfenzhi),3))),128))],64))),128))]),t("tr",null,[(s(!0),a(r,null,c(n(C),(e,o)=>(s(),a(r,{key:e},[(s(!0),a(r,null,c(e.kaohes,(p,y)=>(s(),a("td",{key:`${p}-${y}`,class:$(n(g).arrKHLX[y]===0?"guochengfen":"kaoshifen")},l(Math.round(p.suozhanfenzhi*e.weights)),3))),128))],64))),128))]),(s(!0),a(r,null,c(n(N),(e,o)=>(s(),a("tr",{key:`${e.stdNo}-${o}-${Math.random()}`},[t("td",null,l(o+1),1),t("td",null,l(e.stdNo),1),t("td",null,l(e.stdName),1),(s(!0),a(r,null,c(e.scores,(p,y)=>(s(),a("td",{key:`${e.stdNo}-${p}-${y}-${Math.random()}`,class:$(n(g).arrKHLX[y]===0?"guochengfen":"kaoshifen")},l(p),3))),128)),t("td",null,l(e.stdGuocheng),1),t("td",null,l(e.stdKaoshi),1),t("td",null,l(e.stdHecheng),1)]))),128)),t("tr",null,[it,(s(!0),a(r,null,c(n(_).getStatics.pjf1,(e,o)=>(s(),a("td",{key:`${e}-${o}`},l(e),1))),128))]),t("tr",null,[(s(!0),a(r,null,c(n(_).getStatics.pjf2,(e,o)=>(s(),a("td",{key:`${e}-${o}`},l(e),1))),128))]),t("tr",null,[pt,(s(!0),a(r,null,c(n(M).fmbdcd,(e,o)=>(s(),a("td",{key:`${e}-${o}-${Math.random()}`,colspan:n(d).nSpaned[o]},l(e),9,_t))),128))]),t("tr",null,[ht,t("td",{colspan:n(d).nColMid},l(n(M).dcd),9,mt)]),t("tr",null,[t("td",{colspan:n(d).nColNumTotal,style:{"text-align":"left","padding-left":"1rem"}}," 注：此表一式二份，一份随试卷存档，一份由任课教师所在学院统一保管。",8,ft)])])]),m(n(q),{justify:"center",style:{"margin-top":"2rem"}},{default:f(()=>[m(n(U),{offset:14,span:10},{default:f(()=>[m(n(k),{type:"warning",onClick:K,disabled:T.value},{default:f(()=>[h(l(w.value),1)]),_:1},8,["disabled"]),m(n(k),{type:"primary",disabled:""},{default:f(()=>[h("导出")]),_:1}),m(n(k),{onClick:S[0]||(S[0]=e=>i.$router.push({name:"import-exam-result"}))},{default:f(()=>[h("上一步")]),_:1}),m(n(k),{onClick:R},{default:f(()=>[h("录入新课程")]),_:1})]),_:1})]),_:1})],64))}},kt=X(gt,[["__scopeId","data-v-d645f1c2"]]);export{kt as default};
