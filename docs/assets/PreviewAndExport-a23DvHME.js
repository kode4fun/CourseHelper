import{ar as U,ai as q,at as F,y as H,aj as J,z as Z,k as s,l,p as t,f as n,a7 as r,a8 as u,a9 as p,q as a,a5 as _,a6 as h,s as k,ak as b,bA as O,bB as Q,b5 as S,b6 as $,bC as B}from"./index-DdIp2ATX.js";import{E as W,a as X}from"./el-col-B6ygqop1.js";import{E}from"./el-message-box-mLy_XQI-.js";import"./el-input-CHcDLTp6.js";import"./el-overlay-BddMkEe_.js";const c=g=>(O("data-v-95539e0f"),g=g(),Q(),g),Y={style:{overflow:"auto"}},tt={cellspacing:"0",width:"100%;"},et={class:"tbl-title"},nt=["colspan","innerHTML"],st=["colspan","innerHTML"],lt=c(()=>t("td",{rowspan:"5",class:"mw60"}," 序号 ",-1)),at=c(()=>t("td",{rowspan:"5",class:"mw60"}," 学号 ",-1)),ot=c(()=>t("td",{rowspan:"5",class:"mw60"}," 学生姓名 ",-1)),rt=["colspan","innerHTML"],ut=c(()=>t("td",{colspan:"3"}," 总评成绩",-1)),ct=["colspan"],it=c(()=>t("td",{class:"mw60"}," 过程",-1)),dt=c(()=>t("td",{class:"mw60"}," 期末考试",-1)),pt=c(()=>t("td",{class:"mw140"}," 总分",-1)),_t=c(()=>t("td",{rowspan:"3"},"100",-1)),ht=c(()=>t("td",{rowspan:"3"},"100",-1)),mt={rowspan:"3"},ft=c(()=>t("br",null,null,-1)),gt=c(()=>t("td",{colspan:"3",rowspan:"2"},"平均分",-1)),yt=c(()=>t("td",{colspan:"3"},"课程分目标达成度",-1)),wt=["colspan"],kt=c(()=>t("td",{colspan:"3"},"课程目标达成度",-1)),bt=["colspan"],vt=["colspan"],Tt={__name:"PreviewAndExport",setup(g){const{courseGoalCalHelperStore:y}=q(),{courseInfo:xt,courseGoals:m,students:L,tblTitle:N,tblSubTitle:z,tblZhibiaodianTitle:G,CJGCLabel:I,tblColNum:w,tblColSpanNum:v,pingjunfen:C,pjfGC_KS:T,kcfmbdcd:j,kcmbdcd:R}=F(y),f=H("模拟计算"),x=H(!1),A=()=>new Promise(i=>setTimeout(i,1e3+1500*Math.random())),P=async()=>{if(f.value==="停止计算"){x.value=!0,y.stopComputation().then(()=>{f.value="模拟计算",x.value=!1});return}else return await E.confirm("本操作仅用于模拟和预览各考核项成绩，所生成的数据仅为参考演示用途。请勿将产生的数据作为最终结果，否则一切后果自行负责！","警告",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",icon:S($),duration:0}).then(()=>(f.value="停止计算",y.calulate())).then(async i=>(await A(),i)).then(i=>{if(i.code===0)return B({type:"success",center:!0,message:"计算顺利完成"});if(i.code!==0)return B({type:"error",center:!0,message:"计算完成但遇到错误，请重新计算。"});y.stopComputation()}).catch(()=>{}).finally(()=>{f.value="开始计算"})},V=J(),D=()=>{E.confirm("进入新课程后，本次填入的数据将会丢失！<br>请确定已导出数据后再点击确定按钮进入新课程录入！","警告",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",icon:S($),duration:0}).then(async()=>V.push({name:"index"})).catch(()=>{})};return Z(()=>{}),(i,M)=>(s(),l(r,null,[t("div",Y,[t("table",tt,[t("tr",et,[t("td",{colspan:n(w),innerHTML:n(N)},null,8,nt)]),t("tr",null,[t("td",{colspan:n(w),class:"tbl-subtitle",innerHTML:n(z)},null,8,st)]),t("tr",null,[lt,at,ot,(s(!0),l(r,null,u(n(G),(e,o)=>(s(),l("td",{colspan:n(v)[o],key:"zbt",innerHTML:e,class:"mw170"},null,8,rt))),128)),ut]),t("tr",null,[(s(!0),l(r,null,u(n(v),(e,o)=>(s(),l("td",{colspan:e,key:`${e}${-o}`},a(n(m).value[o].title)+"（*"+a(n(m).value[o].weights)+"） ",9,ct))),128)),it,dt,pt]),t("tr",null,[(s(!0),l(r,null,u(n(m).value,e=>(s(),l(r,{key:e},[(s(!0),l(r,null,u(e.kaohes,o=>(s(),l("td",{key:o,class:k(["mw60",o.kaoheleixing==="过程"?"guochengfen":"kaoshifen"])},a(o.kaohemingcheng),3))),128))],64))),128)),_t,ht,t("td",mt,[p("100"),ft,p("（"+a(n(I))+"）",1)])]),t("tr",null,[(s(!0),l(r,null,u(n(m).value,e=>(s(),l(r,{key:e},[(s(!0),l(r,null,u(e.kaohes,o=>(s(),l("td",{key:o,class:k(o.kaoheleixing==="过程"?"guochengfen":"kaoshifen")},a(o.suozhanfenzhi),3))),128))],64))),128))]),t("tr",null,[(s(!0),l(r,null,u(n(m).value,(e,o)=>(s(),l(r,{key:e},[(s(!0),l(r,null,u(e.kaohes,(d,K)=>(s(),l("td",{key:`${d}-${K}`,class:k(d.kaoheleixing==="过程"?"guochengfen":"kaoshifen")},a(Math.round(d.suozhanfenzhi*e.weights)),3))),128))],64))),128))]),(s(!0),l(r,null,u(n(L).value,(e,o)=>(s(),l("tr",{key:`${e.stdNo}-${Math.random()}`},[t("td",null,a(o+1),1),t("td",null,a(e.stdNo),1),t("td",null,a(e.stdName),1),(s(!0),l(r,null,u(e.scores,d=>(s(),l("td",{key:`${e.stdNo}-${d}-${Math.random()}`,class:k(d.kaoheleixing==="过程"?"guochengfen":"kaoshifen")},a(d.mark),3))),128)),t("td",null,a(e.stdGuocheng),1),t("td",null,a(e.stdKaoshi),1),t("td",null,a(e.stdHecheng),1)]))),128)),t("tr",null,[gt,(s(!0),l(r,null,u(n(C),e=>(s(),l("td",{key:e},a(e.pjf),1))),128)),t("td",null,a(n(T)[0]),1),t("td",null,a(n(T)[1]),1),t("td",null,a(n(T)[2]),1)]),t("tr",null,[(s(!0),l(r,null,u(n(C),e=>(s(),l("td",{key:e},a(e.pjf2),1))),128))]),t("tr",null,[yt,(s(!0),l(r,null,u(n(j),(e,o)=>(s(),l("td",{key:e,colspan:n(v)[o]},a(e.dcd),9,wt))),128))]),t("tr",null,[kt,t("td",{colspan:n(w)-6},a(n(R)),9,bt)]),t("tr",null,[t("td",{colspan:n(w),style:{"text-align":"left","padding-left":"1rem"}},"注：此表一式二份，一份随试卷存档，一份由任课教师所在学院统一保管。",8,vt)])])]),_(n(X),{justify:"center",style:{"margin-top":"2rem"}},{default:h(()=>[_(n(W),{offset:14,span:10},{default:h(()=>[_(n(b),{type:"warning",onClick:P,disabled:x.value},{default:h(()=>[p(a(f.value),1)]),_:1},8,["disabled"]),_(n(b),{type:"primary",disabled:""},{default:h(()=>[p("导出")]),_:1}),_(n(b),{onClick:M[0]||(M[0]=e=>i.$router.push({name:"import-exam-result"}))},{default:h(()=>[p("上一步")]),_:1}),_(n(b),{onClick:D},{default:h(()=>[p("录入新课程")]),_:1})]),_:1})]),_:1})],64))}},Bt=U(Tt,[["__scopeId","data-v-95539e0f"]]);export{Bt as default};
